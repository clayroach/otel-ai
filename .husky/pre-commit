echo "🔍 Running pre-commit checks..."

# Format all code
echo "📝 Formatting code..."
pnpm format

# Auto-stage any files that were formatted
echo "📦 Auto-staging formatted files..."
if [ -n "$(git diff --name-only)" ]; then
    git diff --name-only | xargs git add
    echo "   ✅ Formatted files have been auto-staged"
else
    echo "   ✅ No files needed formatting"
fi

# Run type checking for all packages with agent integration
pnpm typecheck:fix

echo "✅ Pre-commit checks passed!"